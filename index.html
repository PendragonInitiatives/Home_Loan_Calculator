// ------------------------------
// Core Loan Repayment Calculator
// ------------------------------

// Utility: convert % to decimal (monthly rate)
function rateToDecimal(annualRate) {
  return (annualRate / 100) / 12;
}

// Calculate base monthly repayment
function calculateMonthlyRepayment(loanAmount, annualRate, years) {
  const n = years * 12; // total months
  const r = rateToDecimal(annualRate);

  if (r === 0) return loanAmount / n; // no interest edge case
  return loanAmount * r / (1 - Math.pow(1 + r, -n));
}

// Update results safely
function updateResults() {
  // Grab values from DOM by ID
  const loanAmount = parseFloat(document.getElementById("loanValue").value) || 0;
  const loanTerm   = parseFloat(document.getElementById("loanTerm").value) || 30;
  const interest   = parseFloat(document.getElementById("interestRate").value) || 6;

  // Calculate
  const monthly = calculateMonthlyRepayment(loanAmount, interest, loanTerm);
  const total = monthly * loanTerm * 12;
  const totalInterest = total - loanAmount;

  // Push results into DOM
  document.getElementById("regularRepayment").textContent = monthly.toFixed(2);
  document.getElementById("repaymentPeriod").textContent = "month";
  document.getElementById("totalInterest").textContent = totalInterest.toFixed(2);
  document.getElementById("timeSaved").textContent = 0;
  document.getElementById("interestSaved").textContent = 0;
}

// ------------------------------
// Init
// ------------------------------
document.addEventListener("DOMContentLoaded", () => {
  // Run once on page load
  updateResults();

  // Re-run when inputs change
  ["loanValue", "loanTerm", "interestRate"].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.addEventListener("input", updateResults);
  });
});
